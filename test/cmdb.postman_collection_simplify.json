[
  {
    "name": "add ServiceGroup Infrastructure",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/group",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITServiceGroup",
        "fields": {
          "name": "Infrastructure",
          "description": "Infrastructure"
        }
      }
    }
  },
  {
    "name": "delete already referenced asset fail",
    "method": "DELETE",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cabinets/{{cabinet_id}}"
  },
  {
    "name": "login",
    "method": "POST",
    "url": "http://{{auth_api_host}}:{{auth_api_port}}/auth/login",
    "body": {
      "username": "{{auth_user}}",
      "password": "{{auth_passwd}}"
    }
  },
  {
    "name": "patch incident flow 1 status to solved",
    "method": "PATCH",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows/{{incident_flow_1_id}}",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "IncidentFlow",
        "fields": {
          "status": "solved"
        }
      }
    }
  },
  {
    "name": "query all it service",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service"
  },
  {
    "name": "query Cabinets",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cabinets"
  },
  {
    "name": "search configurationItem with eql as parameter",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/searchByEql?page=1&per_page=10",
    "body": {
      "category": "ConfigurationItem",
      "body": {
        "query": {
          "bool": {
            "must": [
              {
                "match": {
                  "status.status": "In_Use"
                }
              },
              {
                "bool": {
                  "should": [
                    {
                      "match": {
                        "it_service": "{{service_email_id}}"
                      }
                    },
                    {
                      "match": {
                        "it_service": "{{service_pop3_id}}"
                      }
                    }
                  ]
                }
              }
            ]
          }
        },
        "sort": [
          {
            "product_date": {
              "order": "desc"
            }
          }
        ]
      }
    }
  },
  {
    "name": "query cabinet by uuid as name",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cabinets/cabinet"
  },
  {
    "name": "patch physical server with os",
    "method": "PATCH",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/{{physical_server_id}}",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "PhysicalServer",
        "fields": {
          "it_service": [
            "{{service_pop3_id}}",
            "{{service_dns_id}}"
          ],
          "sn": "12345678",
          "responsibility": "{{auth_user_id}}",
          "operating_system": "ubuntu",
          "asset_location": {
            "status": "mounted",
            "u": 42,
            "date_mounted": "2016-06-28",
            "cabinet": "cabinet",
            "test": "test"
          }
        }
      }
    }
  },
  {
    "name": "patch incident flow 1 status to closed",
    "method": "PATCH",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows/{{incident_flow_1_id}}",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "IncidentFlow",
        "fields": {
          "status": "closed"
        }
      }
    }
  },
  {
    "name": "add router",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Router",
        "fields": {
          "name": "router",
          "status": {
            "status": "In_Use",
            "fields": {
              "a": 1
            }
          },
          "it_service": [
            "dns"
          ],
          "responsibility": "{{auth_user_id}}",
          "sn": "123456",
          "model": "a10",
          "product_date": "2016-08-11",
          "warranty_expiration_date": "2016-11-11",
          "asset_location": {
            "status": "mounted",
            "u": 42,
            "date_mounted": "2016-06-28",
            "cabinet": "cabinet",
            "test": "test"
          },
          "geo_location": {
            "name": "beijing",
            "location": {
              "lat": 39.98,
              "lon": 116.3
            }
          },
          "used_by_user": {
            "dn": "cn=ron yang,ou=users,dc=test,dc=com",
            "uidNumber": "1000",
            "uid": "ryang"
          },
          "used_by_dept": {
            "dn": "ou=groups,dc=test,dc=com",
            "ou": "groups"
          }
        }
      }
    }
  },
  {
    "name": "get license",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/license"
  },
  {
    "name": "delete incident flow 3",
    "method": "DELETE",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows/{{incident_flow_3_id}}"
  },
  {
    "name": "add physical server",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "PhysicalServer",
        "fields": {
          "name": "physicalserver",
          "it_service": [
            "{{service_email_id}}",
            "{{service_pop3_id}}"
          ],
          "ip_address": [
            "192.168.0.108"
          ],
          "technical_support_info": "010-123456",
          "operating_system": "windows xp",
          "storage_info": "hp-disk1",
          "model": "b10",
          "product_date": "2016-10-11",
          "warranty_expiration_date": "2016-11-11",
          "asset_location": {
            "status": "on_shelf",
            "shelf": "shelf",
            "label": "label",
            "other": "other"
          },
          "management_ip": [
            "192.168.0.108"
          ],
          "monitored": true,
          "asset_id": "test"
        }
      }
    }
  },
  {
    "name": "patch ITService Dns",
    "method": "PATCH",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service/{{service_dns_id}}",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITService",
        "fields": {
          "description": "dns2",
          "group": "Infrastructure"
        }
      }
    }
  },
  {
    "name": "query server room",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/serverRooms"
  },
  {
    "name": "delete already referenced email service fail",
    "method": "DELETE",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service/{{service_email_id}}"
  },
  {
    "name": "add operating system ubuntu",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Software",
        "fields": {
          "name": "ubuntu",
          "description": "ubuntu",
          "subtype": "OperatingSystem"
        }
      }
    }
  },
  {
    "name": "query schema advanced",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/categories/advanced/Software"
  },
  {
    "name": "add switch",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Switch",
        "fields": {
          "name": "switch",
          "it_service": [
            "{{service_dns_id}}"
          ],
          "responsibility": "{{auth_user_id}}",
          "sn": "123456",
          "model": "a10",
          "product_date": "2016-10-11",
          "warranty_expiration_date": "2016-11-11",
          "asset_location": {
            "status": "mounted",
            "u": 42,
            "date_mounted": "2016-06-28",
            "cabinet": "{{cabinet_id}}"
          }
        }
      }
    }
  },
  {
    "name": "query warehouse",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/wareHouses"
  },
  {
    "name": "add warehouse",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/wareHouses",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "WareHouse",
        "fields": {
          "name": "warehouse",
          "description": "warehouse"
        }
      }
    }
  },
  {
    "name": "query ConfigurationItem mounted advanced",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/searchByCypher",
    "body": {
      "category": "ConfigurationItem",
      "cypherQueryFile": "mountedConfigurationItemRels"
    }
  },
  {
    "name": "add ITService Pop3",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITService",
        "fields": {
          "name": "pop3",
          "description": "pop3",
          "group": "{{group_messaging_id}}",
          "parent": "{{service_email_id}}"
        }
      }
    }
  },
  {
    "name": "query router by uuid",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/{{router_id}}"
  },
  {
    "name": "add firewall",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Firewall",
        "fields": {
          "name": "firewall",
          "it_service": [
            "{{service_dns_id}}"
          ],
          "responsibility": "{{auth_user_id}}",
          "sn": "123456",
          "model": "b10",
          "product_date": "2016-10-11",
          "warranty_expiration_date": "2016-11-11",
          "asset_location": {
            "status": "on_shelf",
            "shelf": "{{shelf_id}}",
            "label": "label",
            "other": "other"
          }
        }
      }
    }
  },
  {
    "name": "add ServiceGroup Messaging",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/group",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITServiceGroup",
        "fields": {
          "name": "Messaging",
          "description": "Messaging"
        }
      }
    }
  },
  {
    "name": "query it service reference attributes by uuids",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/searchByCypher",
    "body": {
      "category": "ITService",
      "uuids": [
        "{{service_email_id}}",
        "{{service_pop3_id}}"
      ],
      "cypherQueryFile": "queryITServiceByIds"
    }
  },
  {
    "name": "query ConfigurationItems",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems"
  },
  {
    "name": "cql as parameter",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/searchByCypher",
    "body": {
      "category": "ITService",
      "search": [
        "email",
        "pop3"
      ],
      "cypher": "OPTIONAL MATCH (s1:ITService) WHERE s1.uuid IN {search} or s1.group IN {search} WITH COLLECT(distinct(s1.uuid)) as services_byIds UNWIND {search} as keyword OPTIONAL MATCH (s1:ITService)-[:BelongsTo]->(sg:ITServiceGroup) WHERE s1.name = keyword or sg.name = keyword WITH services_byIds+collect(distinct(s1.uuid)) as services UNWIND services AS service RETURN COLLECT(distinct service)"
    }
  },
  {
    "name": "add incident flow 2 reference incident flow 1",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "IncidentFlow",
        "fields": {
          "it_service": [
            "{{service_dns_id}}"
          ],
          "committer": "{{auth_user_id}}",
          "executor": "{{auth_user_id}}",
          "reference_kb": [
            "{{article_1_id}}"
          ],
          "reference_process_flow": [
            "{{incident_flow_1_id}}"
          ],
          "status": "open",
          "title": "title"
        }
      }
    }
  },
  {
    "name": "query ConfigurationItems by subcategory",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems?subcategory=PhysicalServer,VirtualServer"
  },
  {
    "name": "query all it service groups",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/group"
  },
  {
    "name": "query uuid of it service by service name/id or service group name/id",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/searchByCypher",
    "body": {
      "category": "ITService",
      "search": [
        "email",
        "pop3"
      ],
      "cypherQueryFile": "advanceSearchITService"
    }
  },
  {
    "name": "query Asset Hierarchy",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/categories/Asset"
  },
  {
    "name": "add cabinet ",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cabinets",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Cabinet",
        "fields": {
          "name": "cabinet",
          "description": "cabinet",
          "server_room_id": "{{server_room_id}}"
        }
      }
    }
  },
  {
    "name": "add incident flow 1",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "IncidentFlow",
        "fields": {
          "it_service": [
            "{{service_email_id}}",
            "{{service_pop3_id}}"
          ],
          "committer": "{{auth_user_id}}",
          "executor": "{{auth_user_id}}",
          "reference_kb": [
            "{{article_1_id}}"
          ],
          "status": "open",
          "title": "title"
        }
      }
    }
  },
  {
    "name": "clear all items in db",
    "method": "DELETE",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/items"
  },
  {
    "name": "add shelf",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/shelves",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Shelf",
        "fields": {
          "name": "shelf",
          "description": "shelf",
          "warehouse_id": "warehouse"
        }
      }
    }
  },
  {
    "name": "query operating systems",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems?subcategory=OperatingSystem"
  },
  {
    "name": "add ITService Email With Name Conflict",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITService",
        "fields": {
          "name": "email",
          "description": "email",
          "group": "{{group_messaging_id}}"
        }
      }
    }
  },
  {
    "name": "query it service groups related cmdb servers advanced",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/searchByCypher",
    "body": {
      "category": "ConfigurationItem",
      "cypherQueryFile": "queryHostsByITService",
      "name": [
        "Messaging"
      ]
    }
  },
  {
    "name": "query physical server by uuid",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/{{physical_server_id}}"
  },
  {
    "name": "query process flow by uuid",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows/{{incident_flow_1_id}}"
  },
  {
    "name": "query ConfigurationItems paginated",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems?page=1&per_page=2"
  },
  {
    "name": "query softwares",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems?subcategory=Software"
  },
  {
    "name": "add ITService Email",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITService",
        "fields": {
          "name": "email",
          "description": "email",
          "group": "Messaging"
        }
      }
    }
  },
  {
    "name": "add application",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Software",
        "fields": {
          "subtype": "AntispamGateway",
          "name": "反垃圾邮件网关",
          "provider": "网际思安",
          "version": "1234",
          "key": "1234",
          "quantity": 1,
          "contact_id": "1234",
          "status": {
            "status": "In_Use",
            "fields": {
              "a": 1
            }
          },
          "it_service": [
            "email"
          ],
          "responsibility": "{{auth_user_id}}",
          "sn": "123456",
          "product_date": "2016-08-11",
          "warranty_expiration_date": "2016-11-11"
        }
      }
    }
  },
  {
    "name": "add ITService Dns",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/service",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ITService",
        "fields": {
          "name": "dns",
          "description": "dns",
          "group": "{{group_infrastructure_id}}",
          "dependendents": [
            "email"
          ]
        }
      }
    }
  },
  {
    "name": "query it service groups by keyword",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/it_services/group?keyword=Messaging"
  },
  {
    "name": "query properties of router",
    "method": "GET",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/schema/Router"
  },
  {
    "name": "patch router with it_service",
    "method": "PATCH",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/{{router_id}}",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Router",
        "fields": {
          "it_service": [
            "{{service_pop3_id}}",
            "{{service_email_id}}"
          ],
          "sn": "12345678",
          "responsibility": "{{auth_user_id}}"
        }
      }
    }
  },
  {
    "name": "add operating system",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "Software",
        "fields": {
          "name": "windows xp",
          "description": "Microsoft Windows XP",
          "subtype": "OperatingSystem"
        }
      }
    }
  },
  {
    "name": "add server_room",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/serverRooms",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "ServerRoom",
        "fields": {
          "name": "server_room",
          "description": "机房1"
        }
      }
    }
  },
  {
    "name": "add incident flow 3 with it_service empty",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/processFlows",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "IncidentFlow",
        "fields": {
          "it_service": [],
          "status": "open",
          "test": 1
        }
      }
    }
  },
  {
    "name": "add virtual server",
    "method": "POST",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems",
    "body": {
      "token": "{{token}}",
      "data": {
        "category": "VirtualServer",
        "fields": {
          "name": "virtualserver",
          "it_service": [
            "{{service_email_id}}",
            "{{service_pop3_id}}"
          ],
          "ip_address": [
            "192.168.0.108"
          ],
          "technical_support_info": "010-123456",
          "operating_system": "windows xp",
          "applications": [
            "反垃圾邮件网关"
          ],
          "storage_info": "hp-disk1",
          "model": "b10",
          "product_date": "2016-10-11",
          "warranty_expiration_date": "2016-11-11",
          "management_ip": [
            "192.168.0.108"
          ],
          "monitored": true,
          "host_server": "physicalserver"
        }
      }
    }
  },
  {
    "name": "delete already referenced physical server fail",
    "method": "DELETE",
    "url": "http://{{cmdb_api_host}}:{{cmdb_api_port}}/api/cfgItems/{{physical_server_id}}"
  }
]
